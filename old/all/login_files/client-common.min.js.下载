var xbayCommon=function(n){function e(r){if(a[r])return a[r].exports;var t=a[r]={exports:{},id:r,loaded:!1};return n[r].call(t.exports,t,t.exports,e),t.loaded=!0,t.exports}var a={};return e.m=n,e.c=a,e.p="",e(0)}({0:function(n,e,a){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}Object.defineProperty(e,"__esModule",{value:!0}),e.showSearchWord=void 0;var t=a(54),s=r(t);e.showSearchWord=s.default},54:function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(n,e){var a="; "+e+"=(\\w+)",r=new RegExp(a,"g"),t=r.exec("; "+n);return t&&t[1]};$.support.cors=!0,$.ajaxSetup({contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},headers:{"X-CSRFToken":a(document.cookie,"csrftoken")}});var r='\n    <form class="search-form">\n        <input type="text" class="search-input" placeholder="查词" />\n        <span class="add-on">\n            <i class="ib ib-search"></i>\n        </span>\n        <span class="clear-btn hide">\n            <i class="ib ib-times"></i>\n        </span>\n    </form>\n',t=function(n){return'\n    <div class="popup bottom search-word-result">\n        <div class="content">'+n+"</div>\n    </div>\n"},s=function(n){var e=10,a=n.cn&&n.cn.length&&n.cn.filter(function(n){return n.defn}).length,r=a?n.cn:n.en,t=[];return r.forEach(function(n,a){a>=e?t.push('\n                <div class="word-definition hide">\n                    <span>'+n.pos+"</span>\n                    <span>"+n.defn+"</span>\n                </div>\n            "):t.push('\n                <div class="word-definition">\n                    <span>'+n.pos+"</span>\n                    <span>"+n.defn+"</span>\n                </div>\n            ")}),r.length>e&&t.push('\n            <div class="view-more">\n                <a href="javascript:;">查看更多</a>\n            </div>\n        '),t.join("")},i=function(n,e){if(!n)return"";100===n&&(n=e),0===n&&(n=1);for(var a="",r=1,t=1/e*100+"%";r<=parseInt(e,10);)a+=r<=n?'<div class="bar bar-success bar-reviewed" style="width: '+t+'"></div>':'<div class="bar bar-left" style="width: '+t+'"></div>',r+=1;return'<div class="progress pull-left">'+a+"</div>"},o=function(n){var e="",a=n.pronunciations,r=n.audio_addresses;return a.us&&(e+="<span>us:</span><small> /"+a.us+"/ </small>",r.us.length&&(e+='<i class="ib ib-volume-off" data-url="'+r.us[0]+'"></i>')),a.uk&&(e+="<span>uk:</span><small> /"+a.uk+"/ </small>",r.uk.length&&(e+='<i class="ib ib-volume-off" data-url="'+r.uk[0]+'"></i>')),e},d=function(n){return n.learning_id?'<a class="view-word" href="/review/learning/'+n.learning_id+'" target="_blank">详细</a>':'<a class="view-word" href="/bdc/vocabulary/'+n.id+'" target="_blank">详细</a>'},c=function(n){return n.learning_id?'\n            <a class="forget pull-right" href="javascript:;">我忘了</a>\n            <p class="forget pull-left hide">我们会安排重新复习这个单词</p>\n        ':'\n        <p class="text-right">\n            <button class="add-word button button-success" type="button">添加</button>\n        </p>\n    '},l=function(n){return'\n    <div class="search-word-result popup bottom" data-id="'+n.id+'">\n        <div class="title">\n            <span class="word">'+n.content+"</span>\n            "+d(n)+'\n            <div class="pronunce-bar">'+o(n)+'</div>\n        </div>\n        <div class="content">\n            <div class="word-definitions-list">\n                '+s(n.definitions)+'\n            </div>\n            <div class="add">\n                '+i(n.retention,n.target_retention)+"\n                "+c(n)+'\n            </div>\n            <div class="word-added text-right hide">\n                <span>成功添加进你的词库</span>\n                <a href="javascript:;" target="_blank">查看</a>\n            </div>\n        </div>\n    </div>\n'},u=function(){var n=$(".search-form .clear-btn");n.parent().addClass("focus"),n.removeClass("hide")},p=function(){var n=$(".search-form input"),e=$(".search-form .clear-btn");n.val().trim()||(n.parent().removeClass("focus"),e.addClass("hide"))},f=function(n){n.stopPropagation();var e=$(".search-form input");e.val("").focus()},v=function(n){n.stopPropagation(),$(".search-word-result").remove();var e=$(".nav-top .search-input").val().trim();if(!(""===e||e.length<2)){var a=e.match(/[\w- ]+/);if(!a)return void $(".search-form").append(t("目前只支持搜索英语单词"));$.support.cors=!0,$.ajax({url:"/api/v1/bdc/search/?version=2&word="+e,type:"GET",success:function(n){0===n.status_code?$(".search-form").append(l(n.data)):$(".search-form").append(t(n.msg))},error:function(){$(".search-form").append(t("未找到单词："+e))}})}},h=function(n){n.stopPropagation();var e=$(n.currentTarget),a=e.parents(".search-word-result").attr("data-id");e.attr("disabled",!0),$.ajax({url:"/api/v1/bdc/learning/",type:"POST",data:JSON.stringify({id:a,content_type:"vocabulary"}),success:function(n){$(".word-added").removeClass("hide"),$(".word-added a").attr("href","/review/learning/"+n.data.id)},error:function(){$(".word-added").text("添加失败，请重试").removeClass("hide"),e.attr("disabled",!1)}})},m=function(n){n.stopPropagation();var e=$(n.currentTarget),a=e.parents(".search-word-result").attr("data-id");e.addClass("hide"),$.ajax({url:"/api/v1/bdc/learning/"+a,type:"PUT",data:JSON.stringify({retention:1}),success:function(){e.next().removeClass("hide")},error:function(){e.removeClass("hide"),e.next().text("请求失败，请重试").removeClass("hide")}})},b=function(n){n.stopPropagation(),$(".word-definitions-list").find(".hide").removeClass("hide").end().find(".view-more").addClass("hide")},g=function(n){n.stopPropagation();var e=$(n.currentTarget);e.addClass("ib-volume").removeClass("ib-volume-off");var a=e.attr("data-url"),r=new Audio;r.src=a,r.addEventListener("ended",function(){e.addClass("ib-volume-off").removeClass("ib-volume")},!1),r.play()},w=function(){$(".search-word-result").remove()},x=$("body .nav-top");x.on("focus",".search-input",u),x.on("blur",".search-input",p),x.on("click",".clear-btn",f),x.on("click",".ib-volume-off",g),x.on("click",".add-word",h),x.on("click",".forget",m),x.on("click",".ib-search",v),x.on("submit",".search-form",function(n){n.preventDefault(),v(n)}),x.on("click",".view-more",b),x.on("click",".search-word-result",function(n){return n.stopPropagation()}),$("body").on("click",w),e.default=function(){$(".nav-top-right").prepend(r)}}});